{% extends 'home/base.html' %}

{% load static %}
{% load i18n %}
{% load imagekit %}

{% block main %}
<style>
	body {
		background: url({% static 'main/images/bg.jpg' %}) no-repeat center center fixed; background-size: cover;
	}
</style>

<div class="container pt-5">
     {% if user.tipo_de_usuario == 'SURFERO' %}
        <h1 class="display-4 mt-5 black toggle-chk">
            {% trans 'Purchase History' %}
        </h1>
        <div class="row">
            {% if compras %}
            {% for compra in compras %}
            <div class="col-lg-3 col-12 pb-3 mt-5">
                <div class="card col-12">
                {% generateimage 'home:watermark' source=compra.producto.imagen0 -- class='card-img-top' style='object-fit:cover;' height='150'%}
                  <div class="card-body">
                    <h5 class="card-title text-left">{{ compra.producto.nombre }}</h5>
                    <p class="card-text text-left">{% trans 'Date' %}: {{ compra.fecha }} <br>
                         {% trans 'Price' %}: <strong style="color:black;"> {{ compra.producto.precio }} € </strong> <br>
                         {% trans 'Uploaded by' %}:
                            {% if compra.vendedor.alias %}
                            <a href="{% url 'perfil' nombre=compra.vendedor.alias %}">{{ compra.vendedor.alias }}</a>
                            {% else %}
                            {{ compra.vendedor.first_name }} {{ compra.vendedor.last_name }}
                        {% endif %}
                    </p>
                  </div>
                </div>
            </div>
            {% endfor %}
            {% else %}
            <div class="col-12 text-center mt-5">{% trans 'There are no products here' %} :(</div>
            {% endif %}
        </div>
        {% elif user.tipo_de_usuario == 'FOTOGRAFO' %}
            <h1 class="display-4 mt-5 black toggle-chk" style="cursor:pointer;">
                {% trans 'Sales History' %}
            </h1>
            <div class="row">
                {% if ventas %}
                {% for venta in ventas %}
                <div class="col-lg-3 col-12 pb-3 mt-5">
                    <div class="card col-12">
                    {% generateimage 'home:watermark' source=venta.producto.imagen0 -- class='card-img-top' style='object-fit:cover;' height='150'%}
                      <div class="card-body">
                        <h5 class="card-title text-left">{{ venta.producto.nombre }}</h5>
                        <p class="card-text text-left">{% trans 'Date' %}: {{ venta.fecha }} <br>
                             {% trans 'Price' %}: <strong style="color:black;"> {{ venta.producto.precio }} € </strong> <br>
                             {% trans 'Sold to' %}:
                            <a href="{% url 'perfil' nombre=venta.comprador.username %}">{{ venta.comprador.username }}</a>
                        </p>
                          {% if venta.producto.stock == 0 %}
                          <form action="" method="post">
                              {% csrf_token %}
                            <button type=submit" name="restock" class="btn btn-primary mt-3" value="{{venta.id}}">{% trans 'Restock' %}</button>
                          </form>
                          {% endif %}
                      </div>
                    </div>
                </div>
                {% endfor %}
                {% else %}
                <div class="col-12 text-center mt-5">{% trans 'There are no products here' %} :(</div>
                {% endif %}
            </div>
        {% endif %}
</div>
{% endblock %}